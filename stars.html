<!DOCTYPE html>
<html>
<head>
<title>üåô Your Constellation</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
* {
margin:0;
padding:0;
box-sizing:border-box;
}

body {
background:radial-gradient(ellipse at bottom, #0d0d1a 0%, #000000 100%);
min-height:100vh;
font-family:'Segoe UI', 'Arial', sans-serif;
display:flex;
flex-direction:column;
align-items:center;
padding:20px;
position:relative;
overflow-x:hidden;
}

/* Stars background (twinkling) */
@keyframes twinkle {
0% { opacity:0.3; }
50% { opacity:1; }
100% { opacity:0.3; }
}

.twinkling {
position:fixed;
top:0;
left:0;
width:100%;
height:100%;
pointer-events:none;
z-index:0;
}

.twinkling::before {
content:'';
position:absolute;
width:100%;
height:100%;
background:radial-gradient(2px 2px at 20px 30px, #fff, rgba(0,0,0,0)),
            radial-gradient(2px 2px at 40px 70px, #fff, rgba(0,0,0,0)),
            radial-gradient(2px 2px at 80px 190px, #fff, rgba(0,0,0,0)),
            radial-gradient(2px 2px at 160px 250px, #fff, rgba(0,0,0,0)),
            radial-gradient(2px 2px at 280px 150px, #fff, rgba(0,0,0,0)),
            radial-gradient(2px 2px at 350px 420px, #fff, rgba(0,0,0,0)),
            radial-gradient(2px 2px at 90% 40%, #fff, rgba(0,0,0,0)),
            radial-gradient(2px 2px at 70% 80%, #fff, rgba(0,0,0,0)),
            radial-gradient(3px 3px at 30% 20%, #ffd700, rgba(0,0,0,0));
background-repeat:repeat;
opacity:0.3;
animation:twinkle 4s infinite alternate;
}

/* Main container */
.container {
position:relative;
z-index:2;
width:100%;
max-width:600px;
text-align:center;
}

/* Header */
.header {
margin-bottom:30px;
color:rgba(255,255,255,0.9);
}

h1 {
font-size:28px;
font-weight:300;
letter-spacing:5px;
text-shadow:0 0 20px #ffd700, 0 0 40px #ff69b4;
margin-bottom:10px;
}

.subtitle {
font-size:16px;
color:#ffb6c1;
letter-spacing:2px;
font-style:italic;
border-bottom:1px solid rgba(255,215,0,0.3);
padding-bottom:15px;
}

/* Moon phase indicator */
.moon-phase {
display:flex;
justify-content:center;
align-items:center;
gap:10px;
margin:20px 0;
color:#ffd700;
font-size:20px;
background:rgba(255,255,255,0.05);
padding:12px 25px;
border-radius:50px;
backdrop-filter:blur(5px);
border:1px solid rgba(255,215,0,0.2);
}

.moon-emoji {
font-size:32px;
filter:drop-shadow(0 0 10px gold);
}

/* Canvas for constellation */
.constellation-container {
position:relative;
width:100%;
aspect-ratio:1/1;
background:rgba(0,0,0,0.3);
border-radius:40px;
box-shadow:0 20px 40px rgba(0,0,0,0.8), 0 0 0 2px rgba(255,215,0,0.1) inset;
backdrop-filter:blur(2px);
margin-bottom:20px;
overflow:hidden;
}

canvas {
position:absolute;
top:0;
left:0;
width:100%;
height:100%;
display:block;
touch-action:manipulation;
}

/* Star counter */
.star-counter {
background:rgba(255,255,255,0.1);
backdrop-filter:blur(10px);
padding:15px 25px;
border-radius:50px;
display:inline-block;
margin:20px 0;
border:1px solid rgba(255,215,0,0.3);
}

.star-count-number {
font-size:32px;
font-weight:bold;
color:#ffd700;
text-shadow:0 0 20px gold;
}

.star-count-text {
color:white;
font-size:14px;
letter-spacing:2px;
}

/* Message overlay - STAYS FULLY VISIBLE THEN FADES */
.message-overlay {
position:fixed;
top:50%;
left:50%;
transform:translate(-50%, -50%);
z-index:1000;
background:rgba(10,5,20,0.95);
backdrop-filter:blur(15px);
border:2px solid rgba(255,215,0,0.3);
border-radius:30px;
padding:30px 25px;
max-width:350px;
width:90%;
text-align:center;
box-shadow:0 0 100px rgba(255,105,180,0.3), 0 0 200px rgba(255,215,0,0.2);
opacity:1;
transition:opacity 5s ease; /* Fade takes 5 seconds */
pointer-events:none;
}

.message-overlay.fade-out {
opacity:0;
}

.message-content {
color:white;
}

.message-day {
color:#ffd700;
font-size:14px;
letter-spacing:3px;
margin-bottom:15px;
text-transform:uppercase;
}

.message-text {
font-size:20px;
line-height:1.6;
margin-bottom:20px;
font-weight:300;
white-space:pre-line;
}

.message-star {
font-size:30px;
margin-bottom:10px;
animation:twinkleStar 2s infinite;
}

@keyframes twinkleStar {
0% { opacity:0.8; transform:scale(1); }
50% { opacity:1; transform:scale(1.1); text-shadow:0 0 30px gold; }
100% { opacity:0.8; transform:scale(1); }
}

.message-timing {
color:rgba(255,255,255,0.5);
font-size:12px;
}

/* Day legend - WITH CHECKMARKS FOR CLICKED STARS */
.days-legend {
display:flex;
flex-wrap:wrap;
justify-content:center;
gap:8px;
margin:20px 0;
padding:15px;
background:rgba(255,255,255,0.03);
border-radius:30px;
}

.legend-item {
width:40px;
height:40px;
border-radius:50%;
display:flex;
align-items:center;
justify-content:center;
background:rgba(255,255,255,0.1);
color:white;
font-size:14px;
font-weight:bold;
border:1px solid rgba(255,215,0,0.2);
transition:all 0.3s;
}

.legend-item.filled {
background:#ffd700;
color:black;
font-weight:bold;
box-shadow:0 0 20px gold;
}

.legend-item.visited {
background:rgba(255,215,0,0.3);
border:2px solid #ffd700;
position:relative;
}

.legend-item.visited::after {
content:"‚úì";
position:absolute;
top:-5px;
right:-5px;
background:#ffd700;
color:black;
width:20px;
height:20px;
border-radius:50%;
display:flex;
align-items:center;
justify-content:center;
font-size:12px;
font-weight:bold;
box-shadow:0 0 10px gold;
}

/* Instructions */
.instruction {
color:rgba(255,255,255,0.6);
font-size:14px;
margin:15px 0;
padding:15px;
background:rgba(255,255,255,0.02);
border-radius:20px;
font-style:italic;
}

/* Reset button (hidden but accessible) */
.reset-area {
opacity:0.2;
transition:0.3s;
cursor:pointer;
margin-top:30px;
font-size:12px;
}

.reset-area:hover {
opacity:1;
}

/* Mobile adjustments */
@media (max-width:480px) {
h1 { font-size:24px; }
.message-text { font-size:18px; }
.message-overlay { padding:25px 20px; }
.legend-item { width:35px; height:35px; }
}

/* Save indicator */
.save-indicator {
color:rgba(255,255,255,0.3);
font-size:10px;
margin-top:5px;
}
</style>
</head>
<body>

<div class="twinkling"></div>

<div class="container">
    <div class="header">
        <h1>‚ú¶ YOUR CONSTELLATION ‚ú¶</h1>
        <div class="subtitle">each star = a day you chose progress</div>
    </div>
    
    <!-- Moon phase showing progress -->
    <div class="moon-phase" id="moonPhase">
        <span class="moon-emoji">üåë</span>
        <span id="phaseText">new moon ‚Ä¢ 0 stars</span>
        <span class="moon-emoji">üåë</span>
    </div>
    
    <!-- Constellation Canvas -->
    <div class="constellation-container">
        <canvas id="constellationCanvas"></canvas>
    </div>
    
    <!-- Star Counter -->
    <div class="star-counter">
        <span class="star-count-number" id="starCount">0</span>
        <span class="star-count-text"> STARS IN YOUR SKY</span>
    </div>
    
    <!-- Mini calendar of days - WITH CHECKMARKS -->
    <div class="days-legend" id="daysLegend"></div>
    
    <div class="instruction">
        ‚ú¶ tap any star ‚ú¶ <br>
        message stays for 8 seconds, then fades gently
    </div>
    
    <!-- Save indicator (auto-saves which stars she's clicked) -->
    <div class="save-indicator">‚ú¶ memories are saved ‚ú¶</div>
    
    <!-- Hidden reset (tap 5 times to reset) -->
    <div class="reset-area" onclick="resetConstellation()">‚òæ reset all stars ‚òΩ</div>
</div>

<!-- Message overlay -->
<div id="messageOverlay" class="message-overlay" style="display:none;">
    <div class="message-content">
        <div class="message-star" id="messageStar">‚≠ê</div>
        <div class="message-day" id="messageDay">DAY 1</div>
        <div class="message-text" id="messageText">You showed up today.</div>
        <div class="message-timing" id="messageTiming">‚ú¶ visible for 8 seconds ‚ú¶</div>
    </div>
</div>

<script>
// =============================================
// YOUR STARS - ADD ONE EACH DAY
// Each star = one day she studied
// =============================================
const stars = [
    // DAY 1 (Romantic opener)
    { 
        day: 1,
        x: 200, 
        y: 150, 
        message: "The first day is always the hardest.\nYou showed up anyway.\nThat's how I knew you were different.",
        emoji: "‚ú®",
        type: "romantic"
    },
    
    // DAY 2 (Motivating)
    { 
        day: 2,
        x: 350, 
        y: 220, 
        message: "Two days in a row.\nConsistency is rare.\nYou're rarer.",
        emoji: "‚≠ê",
        type: "motivating"
    },
    
    // DAY 3 (Cute)
    { 
        day: 3,
        x: 150, 
        y: 320, 
        message: "Day 3.\nYou're building something beautiful.\nAnd I'm here, watching, smiling.",
        emoji: "üåü",
        type: "cute"
    },
    
    // DAY 4 (Deep)
    { 
        day: 4,
        x: 280, 
        y: 400, 
        message: "Most people quit by now.\nBut you?\nYou're just getting started.",
        emoji: "üí´",
        type: "deep"
    },
    
    // DAY 5 (Romantic)
    { 
        day: 5,
        x: 420, 
        y: 330, 
        message: "Five days.\nDo you realize what you're doing?\nYou're becoming the person you dreamed of.",
        emoji: "üíï",
        type: "romantic"
    },
    
    // DAY 6 (Motivating)
    { 
        day: 6,
        x: 90, 
        y: 470, 
        message: "The version of you on Day 1\nwould be so proud of Day 6 you.\nI know I am.",
        emoji: "‚ö°",
        type: "motivating"
    },
    
    // DAY 7 (Cute - One week!)
    { 
        day: 7,
        x: 480, 
        y: 180, 
        message: "ONE WEEK.\nSeven stars.\nYou're building a galaxy, one day at a time.",
        emoji: "üåô",
        type: "cute"
    },
    
    // DAY 8 (Romantic)
    { 
        day: 8,
        x: 220, 
        y: 530, 
        message: "You in flow state?\nThat focused version of you?\nThat's my favorite character.",
        emoji: "üíó",
        type: "romantic"
    },
    
    // DAY 9 (Motivating)
    { 
        day: 9,
        x: 380, 
        y: 490, 
        message: "Nine days of choosing yourself.\nThat's not luck.\nThat's discipline. That's you.",
        emoji: "üî•",
        type: "motivating"
    },
    
    // DAY 10 (Double digits!)
    { 
        day: 10,
        x: 120, 
        y: 590, 
        message: "üîü DOUBLE DIGITS!\nTen days of showing up.\nYou're unstoppable now.",
        emoji: "üí´",
        type: "cute"
    },
    
    // DAY 11 (Romantic)
    { 
        day: 11,
        x: 440, 
        y: 580, 
        message: "Eleven days.\nEvery day I notice something new.\nToday? The fire in your eyes.",
        emoji: "‚ú®",
        type: "romantic"
    },
    
    // DAY 12 (Deep)
    { 
        day: 12,
        x: 270, 
        y: 220, 
        message: "You're halfway to a habit.\nBut to me?\nYou've already become a necessity.",
        emoji: "üí´",
        type: "deep"
    },
    
    // DAY 13 (Motivating)
    { 
        day: 13,
        x: 70, 
        y: 330, 
        message: "Day 13.\nUnlucky for some.\nBut you? You make your own luck.",
        emoji: "üçÄ",
        type: "motivating"
    },
    
    // DAY 14 (Two weeks!)
    { 
        day: 14,
        x: 520, 
        y: 420, 
        message: "TWO WEEKS.\nA constellation is forming.\nAnd you're the brightest star.",
        emoji: "üåü",
        type: "cute"
    },
    
    // DAY 15 (Half month - Romantic)
    { 
        day: 15,
        x: 180, 
        y: 250, 
        message: "Fifteen days.\nHalf a month of choosing progress.\nYou're not just dreaming anymore.\nYou're becoming.",
        emoji: "üíñ",
        type: "romantic"
    },
    
    // DAY 16 (Cute)
    { 
        day: 16,
        x: 400, 
        y: 90, 
        message: "Day 16.\nEvery star you add\nmakes the sky more beautiful.\nJust like you.",
        emoji: "ü•∞",
        type: "cute"
    },
    
    // DAY 17 (Motivating)
    { 
        day: 17,
        x: 320, 
        y: 620, 
        message: "Seventeen days.\nMost dreams die by now.\nBut yours?\nIt's just getting brighter.",
        emoji: "‚ö°",
        type: "motivating"
    },
    
    // DAY 18 (Deep)
    { 
        day: 18,
        x: 40, 
        y: 530, 
        message: "I've been watching you for 18 days.\nAnd I still can't look away.\nThat means something.",
        emoji: "üëÄ",
        type: "deep"
    },
    
    // DAY 19 (Romantic)
    { 
        day: 19,
        x: 460, 
        y: 270, 
        message: "Nineteen days.\nYou know what I love most?\nThe way you don't even realize\nhow amazing you are.",
        emoji: "üíï",
        type: "romantic"
    },
    
    // DAY 20 (Milestone)
    { 
        day: 20,
        x: 230, 
        y: 450, 
        message: "TWENTY DAYS!\nTwo-thirds of the way.\nYou're not just consistent.\nYou're extraordinary.",
        emoji: "üèÜ",
        type: "cute"
    },
    
    // DAY 21 (Three weeks)
    { 
        day: 21,
        x: 130, 
        y: 110, 
        message: "Three weeks.\n21 days to form a habit.\nYou've formed something else too:\nA place in my thoughts.",
        emoji: "üí≠",
        type: "romantic"
    },
    
    // DAY 22 (Motivating)
    { 
        day: 22,
        x: 360, 
        y: 550, 
        message: "Day 22.\nYou're past the hard part.\nNow? Now you fly.",
        emoji: "ü¶ã",
        type: "motivating"
    },
    
    // DAY 23 (Cute)
    { 
        day: 23,
        x: 500, 
        y: 70, 
        message: "Twenty-three stars.\nThe sky is getting crowded.\nBut you still shine the brightest.",
        emoji: "‚ú®",
        type: "cute"
    },
    
    // DAY 24 (Deep)
    { 
        day: 24,
        x: 60, 
        y: 410, 
        message: "I don't just admire your effort.\nI admire you.\nThe person behind the discipline.\nThat's who I'm falling for.",
        emoji: "üíó",
        type: "deep"
    },
    
    // DAY 25 (Almost there!)
    { 
        day: 25,
        x: 290, 
        y: 350, 
        message: "25 days.\nFive days from a full month.\nYou're so close.\nAnd I'm so proud.",
        emoji: "üéØ",
        type: "motivating"
    },
    
    // DAY 26 (Romantic)
    { 
        day: 26,
        x: 410, 
        y: 480, 
        message: "Twenty-six days of showing up.\nTwenty-six days of proving yourself.\nBut to me?\nYou had nothing to prove.\nYou were already enough.",
        emoji: "üíù",
        type: "romantic"
    },
    
    // DAY 27 (Cute)
    { 
        day: 27,
        x: 190, 
        y: 580, 
        message: "Three days left.\nThe constellation is almost complete.\nBut us? We're just beginning.",
        emoji: "üåÖ",
        type: "cute"
    },
    
    // DAY 28 (Four weeks)
    { 
        day: 28,
        x: 330, 
        y: 140, 
        message: "Four weeks.\nA full lunar cycle.\nThe moon changed.\nYou changed too.\nFor the better.",
        emoji: "üåï",
        type: "deep"
    },
    
    // DAY 29 (Anticipation)
    { 
        day: 29,
        x: 100, 
        y: 210, 
        message: "One more day.\nOne more star.\nTomorrow, the sky will be complete.\nBut my admiration?\nIt'll never end.",
        emoji: "‚≠ê",
        type: "romantic"
    },
    
    // DAY 30 (ONE MONTH - FINAL)
    { 
        day: 30,
        x: 300, 
        y: 300, 
        message: "‚ú®‚ú®‚ú® ONE MONTH ‚ú®‚ú®‚ú®\n\nThirty days.\nThirty stars.\nA full constellation.\n\nYou did it.\nYou showed up every single day.\nYou built something beautiful.\nNot just in the sky.\nIn yourself.\n\nAnd me?\nI got to watch.\nI got to witness.\nI got to fall a little more\nwith every single day.\n\nThis is your sky now.\nBuilt by you.\nStar by star.\nDay by day.\n\nAnd I'll be here.\nFor the next month.\nAnd the one after that.\nAnd the one after that.\n\nBecause some constellations\nare worth watching forever.\n\nI love watching you shine. üíï",
        emoji: "üëë",
        type: "special"
    }
];

// =============================================
// TRACK CLICKED STARS (saves in browser)
// =============================================
let clickedStars = JSON.parse(localStorage.getItem('clickedStars')) || [];

// =============================================
// CONFIGURATION
// =============================================
let currentStars = stars;
let messageTimeout;
let fadeTimeout;

// Get canvas and context
const canvas = document.getElementById('constellationCanvas');
const ctx = canvas.getContext('2d');

// Set canvas size
function resizeCanvas() {
    const container = document.querySelector('.constellation-container');
    canvas.width = container.clientWidth;
    canvas.height = container.clientHeight;
    drawConstellation();
}

// Draw REALISTIC star - BIGGER with CLEARER NUMBERS
function drawStar(ctx, cx, cy, spikes, outerR, innerR, color) {
    let rot = Math.PI / 2 * 3;
    let step = Math.PI / spikes;
    
    ctx.beginPath();
    for (let i = 0; i < spikes; i++) {
        let x = cx + Math.cos(rot) * outerR;
        let y = cy + Math.sin(rot) * outerR;
        ctx.lineTo(x, y);
        rot += step;
        
        x = cx + Math.cos(rot) * innerR;
        y = cy + Math.sin(rot) * innerR;
        ctx.lineTo(x, y);
        rot += step;
    }
    ctx.closePath();
    ctx.fill();
}

// Draw constellation with BIGGER stars and CLEARER numbers
function drawConstellation() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    // Draw faint connection lines between consecutive stars
    if (currentStars.length > 1) {
        ctx.beginPath();
        ctx.strokeStyle = 'rgba(255,215,0,0.15)';
        ctx.lineWidth = 1;
        
        for (let i = 0; i < currentStars.length - 1; i++) {
            ctx.moveTo(currentStars[i].x, currentStars[i].y);
            ctx.lineTo(currentStars[i + 1].x, currentStars[i + 1].y);
        }
        ctx.stroke();
    }
    
    // Draw each star - BIGGER SIZE
    currentStars.forEach((star, index) => {
        const x = star.x;
        const y = star.y;
        
        // Star color based on type
        const starColor = getStarColor(star.type);
        
        // BIGGER glow effect
        ctx.shadowColor = starColor;
        ctx.shadowBlur = 25;
        ctx.fillStyle = starColor;
        
        // Draw BIGGER realistic star with 5 points
        // outerR increased from 12 to 16, innerR from 5 to 7
        drawStar(ctx, x, y, 5, 16, 7, starColor);
        
        // Add a BIGGER tiny inner star for sparkle
        ctx.shadowBlur = 35;
        ctx.fillStyle = 'white';
        drawStar(ctx, x, y, 5, 7, 3, 'white');
        
        // Day number - MUCH MORE VISIBLE with white background
        ctx.shadowBlur = 0;
        
        // Draw white background circle for number
        ctx.fillStyle = 'rgba(0,0,0,0.8)';
        ctx.beginPath();
        ctx.arc(x, y, 11, 0, Math.PI * 2);
        ctx.fill();
        
        // Draw border around number
        ctx.strokeStyle = starColor;
        ctx.lineWidth = 2;
        ctx.beginPath();
        ctx.arc(x, y, 11, 0, Math.PI * 2);
        ctx.stroke();
        
        // Draw the day number in BRIGHT WHITE, BOLD, LARGER
        ctx.fillStyle = 'white';
        ctx.font = 'bold 14px Arial'; // Bigger font
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.fillText(star.day, x, y);
    });
    
    // Reset shadow
    ctx.shadowBlur = 0;
    
    // Update counters
    updateCounters();
}

function getStarColor(type) {
    switch(type) {
        case 'romantic': return '#ff69b4';
        case 'motivating': return '#ffd700';
        case 'cute': return '#ffb6c1';
        case 'deep': return '#9370db';
        default: return '#ffd700';
    }
}

// Update star counter and moon phase
function updateCounters() {
    const count = currentStars.length;
    document.getElementById('starCount').innerText = count;
    
    // Update moon phase
    const moonEmojis = ['üåë', 'üåí', 'üåì', 'üåî', 'üåï'];
    const phaseIndex = Math.min(Math.floor(count / 7), 4);
    document.querySelectorAll('.moon-emoji').forEach(el => {
        el.innerText = moonEmojis[phaseIndex];
    });
    document.getElementById('phaseText').innerText = 
        ['new moon', 'waxing crescent', 'first quarter', 'waxing gibbous', 'full moon'][phaseIndex] + 
        ` ‚Ä¢ ${count} stars`;
    
    // Update days legend with checkmarks for clicked stars
    updateDaysLegend();
}

// Update days legend with checkmarks
function updateDaysLegend() {
    const legend = document.getElementById('daysLegend');
    legend.innerHTML = '';
    
    for (let i = 1; i <= 30; i++) {
        const day = document.createElement('div');
        day.className = 'legend-item';
        
        // Check if this day exists as a star
        const starExists = currentStars.some(s => s.day === i);
        
        if (starExists) {
            day.classList.add('filled');
        }
        
        // Check if this star has been clicked
        if (clickedStars.includes(i)) {
            day.classList.add('visited');
        }
        
        day.innerText = i;
        legend.appendChild(day);
    }
}

// Show message overlay - STAYS 8 SECONDS THEN FADES IN 5 SECONDS
function showMessage(star) {
    const overlay = document.getElementById('messageOverlay');
    const messageDay = document.getElementById('messageDay');
    const messageText = document.getElementById('messageText');
    const messageStar = document.getElementById('messageStar');
    const messageTiming = document.getElementById('messageTiming');
    
    // Clear any existing timeouts
    if (messageTimeout) clearTimeout(messageTimeout);
    if (fadeTimeout) clearTimeout(fadeTimeout);
    
    // Remove any existing fade class
    overlay.classList.remove('fade-out');
    
    // Set message content
    messageDay.innerText = `DAY ${star.day}`;
    messageText.innerText = star.message;
    messageStar.innerText = star.emoji || '‚ú®';
    messageTiming.innerText = '‚ú¶ visible for 8 seconds ‚ú¶';
    
    // Show overlay immediately
    overlay.style.display = 'block';
    
    // Force reflow
    void overlay.offsetWidth;
    
    // Mark this star as clicked
    if (!clickedStars.includes(star.day)) {
        clickedStars.push(star.day);
        localStorage.setItem('clickedStars', JSON.stringify(clickedStars));
        updateDaysLegend();
    }
    
    // Stay fully visible for 8 seconds
    messageTimeout = setTimeout(() => {
        // Start fading (takes 5 seconds)
        overlay.classList.add('fade-out');
        messageTiming.innerText = '‚ú¶ fading away... ‚ú¶';
        
        // Hide completely after fade
        fadeTimeout = setTimeout(() => {
            overlay.style.display = 'none';
            overlay.classList.remove('fade-out');
        }, 5000); // 5 second fade
    }, 8000); // 8 seconds fully visible
}

// Handle star clicks
canvas.addEventListener('click', function(e) {
    const rect = canvas.getBoundingClientRect();
    const scaleX = canvas.width / rect.width;
    const scaleY = canvas.height / rect.height;
    
    const clickX = (e.clientX - rect.left) * scaleX;
    const clickY = (e.clientY - rect.top) * scaleY;
    
    // Check each star (from last to first so newer stars are on top)
    for (let i = currentStars.length - 1; i >= 0; i--) {
        const star = currentStars[i];
        const distance = Math.hypot(clickX - star.x, clickY - star.y);
        if (distance < 25) {
            showMessage(star);
            break;
        }
    }
});

// Touch support
canvas.addEventListener('touchstart', function(e) {
    e.preventDefault();
    const rect = canvas.getBoundingClientRect();
    const touch = e.touches[0];
    const scaleX = canvas.width / rect.width;
    const scaleY = canvas.height / rect.height;
    
    const touchX = (touch.clientX - rect.left) * scaleX;
    const touchY = (touch.clientY - rect.top) * scaleY;
    
    for (let i = currentStars.length - 1; i >= 0; i--) {
        const star = currentStars[i];
        const distance = Math.hypot(touchX - star.x, touchY - star.y);
        if (distance < 30) {
            showMessage(star);
            break;
        }
    }
}, {passive: false});

// Reset function (hidden, for your use only)
function resetConstellation() {
    if (confirm('Reset all clicked stars?')) {
        clickedStars = [];
        localStorage.removeItem('clickedStars');
        updateDaysLegend();
    }
}

// Initialize
window.addEventListener('resize', resizeCanvas);
resizeCanvas();

// Auto-update every time page loads
window.onload = function() {
    resizeCanvas();
    updateCounters();
};
</script>
</body>

</html>
